= Production procedures

== MAC address change

This procedure explain how to modify the puppet-hpc configuration to change an
hardware ethernet address after a motherboard replacement, for example.

=== Change the network.yaml file

First, the yaml file in the hieradata repository containing the
`master_network` hash must be edited to replace the old hardware address. A
description of this hash can be found in the Intallation section of this guide.

=== Push the new configuration and apply it

The modified configuration must be pushed to the shared administration 
directory xith the `hpc-config-push` command:

----
# hpc-config-push
INFO: creating archive /tmp/puppet-config-push/tmp_ndq0ujz/puppet-config-environment.tar.xz
INFO: S3 push: pushing data in bucket s3-system
----

Then apply the configuration on the `service` nodes, who runs the dhcp server:

----
# hpc-config-apply
----

NOTE: It is not possible to run the `hpc-config-apply` on all the service nodes
at the same time exactly. A short delay must be respected as the ceph service
can be disturbed by a restart of the network service.

== Password/keys changes

////
TODO: document how-to change all passwords, keys (including SSH host keys) and certificates.
////

== Service node re-installation

////
TODO: document how-to re-install a generic service node with Ceph and friends.
////
